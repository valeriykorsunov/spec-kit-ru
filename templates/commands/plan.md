---
description: Выполните рабочий процесс планирования реализации, используя шаблон плана для создания проектных артефактов.
handoffs: 
  - label: Создать задачи
    agent: speckit.tasks
    prompt: Разбей план на задачи
    send: true
  - label: Создать чек-лист
    agent: speckit.checklist
    prompt: Создай чек-лист для следующей предметной области...
scripts:
  sh: scripts/bash/setup-plan.sh --json
  ps: scripts/powershell/setup-plan.ps1 -Json
agent_scripts:
  sh: scripts/bash/update-agent-context.sh __AGENT__
  ps: scripts/powershell/update-agent-context.ps1 -AgentType __AGENT__
---

## Пользовательский ввод

```text
$ARGUMENTS
```

Вы **ОБЯЗАНЫ** учесть ввод пользователя перед продолжением (если он не пустой).

## План действий

1. **Настройка**: Запустите `{SCRIPT}` из корня репозитория и разберите JSON для получения FEATURE_SPEC, IMPL_PLAN, SPECS_DIR, BRANCH. Для одиночных кавычек в аргументах используйте экранирование: например 'I'\''m Groot' (или двойные кавычки, если возможно: "I'm Groot").

2. **Загрузка контекста**: Прочитайте FEATURE_SPEC и `/memory/constitution.md`. Загрузите шаблон IMPL_PLAN (уже скопирован).

3. **Выполнение рабочего процесса**: Следуйте структуре шаблона IMPL_PLAN, чтобы:
   - Заполнить Технический Контекст (пометьте неизвестное как "NEEDS CLARIFICATION")
   - Заполнить раздел Проверка Конституции (Constitution Check) на основе constitution.md
   - Оценить контрольные точки (ERROR если нарушения не обоснованы)
   - Фаза 0: Создать research.md (разрешить все NEEDS CLARIFICATION)
   - Фаза 1: Создать data-model.md, contracts/, quickstart.md
   - Фаза 1: Обновить контекст агента, запустив скрипт агента
   - Переоценить Проверку Конституции после проектирования

4. **Завершение и отчет**: Команда завершается после планирования Фазы 2. Сообщите ветку, путь к IMPL_PLAN и созданные артефакты.

## Фазы

### Фаза 0: Структура и Исследование

1. **Извлечение неизвестных из Технического Контекста** выше:
   - Для каждого NEEDS CLARIFICATION → задача на исследование
   - Для каждой зависимости → задача на лучшие практики
   - Для каждой интеграции → задача на паттерны

2. **Генерация и отправка агентов исследования**:

   ```text
   Для каждого неизвестного в Техническом Контексте:
     Задача: "Research {unknown} for {feature context}"
   Для каждого выбора технологии:
     Задача: "Find best practices for {tech} in {domain}"
   ```

3. **Консолидация находок** в `research.md` используя формат:
   - Решение: [что выбрано]
   - Обоснование: [почему выбрано]
   - Рассмотренные альтернативы: [что еще оценивалось]

**Результат**: research.md с разрешенными всеми пунктами NEEDS CLARIFICATION

### Фаза 1: Проектирование и Контракты

**Предварительные требования:** `research.md` завершен

1. **Извлечение сущностей из спецификации функции** → `data-model.md`:
   - Имя сущности, поля, связи
   - Правила валидации из требований
   - Переходы состояний, если применимо

2. **Генерация контрактов API** из функциональных требований:
   - Для каждого действия пользователя → эндпоинт
   - Используйте стандартные паттерны REST/GraphQL
   - Вывод схемы OpenAPI/GraphQL в `/contracts/`

3. **Обновление контекста агента**:
   - Запустите `{AGENT_SCRIPT}`
   - Эти скрипты определяют, какой AI агент используется
   - Обновите соответствующий файл контекста агента
   - Добавляйте только новые технологии из текущего плана
   - Сохраняйте ручные добавления между маркерами

**Результат**: data-model.md, /contracts/*, quickstart.md, файл специфичный для агента

## Ключевые правила

- Используйте абсолютные пути
- ERROR (ОШИБКА) при сбоях на контрольных точках (gates) или неразрешенных уточнениях
